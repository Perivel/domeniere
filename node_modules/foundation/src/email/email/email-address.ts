import { EmailInterface } from "./email.interface";
import * as EmailValidator from 'email-validator';
import { Equatable, InvalidArgumentException } from "../../common/common.module";

/**
 * EmailAddress
 * 
 * EmailAddress provides functionality for handling email addresses.
 */

export class EmailAddress implements EmailInterface, Equatable {

    private readonly _value: string;

    /**
     * Creates an instance of an email address.
     * @param value The value of the email address.
     * @throws InvalidArgumentException when the email address value is invalid.
     */
    constructor(value: string) {
        
        if (EmailValidator.validate(value)) {
            this._value = value;
        }
        else {
            // email is invalid.
            throw new InvalidArgumentException();
        }
    }

    /**
     * email()
     * 
     * email() gets the value of the email address.
     */

    public email(): string {
        return this._value;
    }

    /**
     * equals()
     * 
     * equals() compares the instance to the suspect, to determine if they are equal.
     * @param suspect The suspect to be compared.
     */

    public equals(suspect: any): boolean {

        let isEqual = false;

        if (suspect instanceof EmailAddress) {
            const other = suspect as EmailAddress;
            isEqual = this.email() === other.email();
        }

        return isEqual;
    }
}
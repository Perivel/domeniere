import { Timestamp } from './../../src/dates/dates.module';

test("Create a timestamp from an existing date.", () => {
    const localDate = new Date();
    const utcDate = new Date(Date.UTC(localDate.getFullYear(), localDate.getMonth(), localDate.getDate(), localDate.getHours(), localDate.getMinutes(), localDate.getSeconds(), localDate.getMilliseconds()));
    const timestamp = new Timestamp(utcDate);
    expect(timestamp).toBeDefined();
    expect(timestamp.value()).toEqual(utcDate);
});

test('Generate a timestamp.', () => {
    const timestamp = Timestamp.Now();
    expect(timestamp).toBeDefined();
});

test('Adding and subtracting days', () => {
    const initialDate = new Date(Date.UTC(2020, 6, 10, 5, 30, 0, 0));
    const timestamp = new Timestamp(initialDate);

    // add one day.
    const addedDats = new Date(Date.UTC(2020, 6, 11, 5, 30, 0, 0));
    const addedDatesTs = timestamp.addDays(1);
    expect(addedDatesTs.value()).toEqual(addedDats);

    // subtract one day.
    const subtractedDaysTs = addedDatesTs.subtractDays(1);
    expect(subtractedDaysTs.value()).toEqual(initialDate);

    // add a full month
    const newDate = new Date(Date.UTC(2020, 7, 10, 5, 30, 0, 0));
    const newMonthTs = timestamp.addDays(30);
    expect(newMonthTs.value()).toEqual(newDate);

    // subtract an entire month.
    const subtractMonthTs = newMonthTs.subtractDays(30);
    expect(subtractMonthTs.value()).toEqual(initialDate);
});

test("Get the components of the timestamp.", () => {
    const date = new Date(Date.UTC(2020, 6, 10, 5, 30, 0, 0));
    const ts = new Timestamp(date);
    expect(ts.month()).toEqual(6); 
    expect(ts.day()).toEqual(10); 
    expect(ts.year()).toEqual(2020);
});

test("Adding and subtracting months", () => {
    const initialDate = new Date(Date.UTC(2020, 6, 10, 5, 30, 0, 0));
    const timestamp = new Timestamp(initialDate);
    const futureDate = new Date(Date.UTC(2020, 9, 10, 5, 30, 0, 0));
    expect(timestamp.addMonths(3).value()).toEqual(futureDate);

    const pastDate = new Date(Date.UTC(2020, 3, 10, 5, 30, 0, 0));
    expect(timestamp.subtractMonths(3).value()).toEqual(pastDate);
});

test("Add and subtract years.", () => {
    const date = new Date(Date.UTC(2020, 6, 10, 5, 30, 0, 0));
    const ts = new Timestamp(date);
    expect(ts.year()).toEqual(2020);
    expect(ts.addYears(1).year()).toEqual(2021);
    expect(ts.subtractYears(1).year()).toEqual(2019);
});